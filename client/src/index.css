@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================================================
   Civilla: Fixed navbar shell (no blur, no color changes)
   - Avoids sticky failures caused by overflow parents
   - Adds top padding only when enabled via body attribute
   ========================================================= */

:root {
  --civilla-nav-h: 0px;
  
  /* Input field light green background - preserved across themes */
  --input-bg: #EEF7F1;
}

/* ---------------------------
   MARKETING THEME (PRE-LOGIN)
   Warm cream + bush green
--------------------------- */
.theme-marketing {
  --background: 40 37.5% 96.9%;      /* #FAF8F4 warm cream */
  --foreground: 20 17% 3%;           /* near-black */
  --primary: 158 52% 15%;            /* #0F3B2E green brand */
  --primary-foreground: 40 37.5% 96.9%;
  --muted: 158 10% 83%;              /* #CFD7D5 */
  --muted-foreground: 20 10% 35%;
  --border: 158 8% 75%;
  --input: 158 10% 83%;
  --card: 40 28% 98%;
  --card-foreground: 20 17% 3%;
  --popover: 40 28% 92%;
  --popover-foreground: 20 17% 3%;
  --ring: 158 52% 15%;
  --destructive: 0 72% 28%;          /* #7A1F1F */
  --destructive-foreground: 40 37.5% 96.9%;
  --secondary: 0 0% 95%;
  --secondary-foreground: 20 17% 3%;
  --accent: 158 10% 83%;
  --accent-foreground: 20 17% 3%;
}

/* MARKETING DARK MODE */
.theme-marketing.dark {
  --background: 165 12% 8%;          /* deep green-black */
  --foreground: 40 25% 94%;
  --primary: 158 52% 30%;            /* brighter green accent */
  --primary-foreground: 165 12% 8%;
  --muted: 165 10% 18%;
  --muted-foreground: 165 8% 60%;
  --border: 165 10% 22%;
  --input: 165 10% 18%;
  --card: 165 10% 12%;
  --card-foreground: 40 25% 94%;
  --popover: 165 10% 14%;
  --popover-foreground: 40 25% 94%;
  --ring: 158 52% 30%;
  --destructive: 0 60% 35%;
  --destructive-foreground: 40 25% 94%;
  --secondary: 165 8% 16%;
  --secondary-foreground: 40 25% 94%;
  --accent: 165 10% 20%;
  --accent-foreground: 40 25% 94%;
}

/* =========================================================
   APP THEME (POST-LOGIN)
   Background: #F2F2F2, Cards/Tiles: #A2BEC2, Borders/Text: #1E2020
   Primary (nav/footer/buttons): #314143 with text #F2F2F2
========================================================= */
.app-shell {
  /* Background: #F2F2F2 neutral light gray */
  --background: 0 0% 95%;                 /* #F2F2F2 */
  --foreground: 180 3% 12%;               /* #1E2020 */

  /* Cards & surfaces: #A2BEC2 blue-gray tiles */
  --card: 187.5 20.8% 69.8%;              /* #A2BEC2 */
  --card-foreground: 180 3% 12%;          /* #1E2020 */

  --popover: 0 0% 100%;                   /* pure white for menus */
  --popover-foreground: 180 3% 12%;       /* #1E2020 */

  /* Muted: slightly darker than background */
  --muted: 186.7 20% 86%;                 /* subtle blue-gray */
  --muted-foreground: 180 3% 25%;

  /* Borders: #1E2020 dark */
  --border: 180 3% 12%;                   /* #1E2020 */
  --input: 189 23% 87%;                   /* #D6E4E6 slightly bluer */
  --ring: 186.7 15.5% 22.7%;              /* near primary */

  /* Primary = Dark Blue #314143 */
  --primary: 186.7 15.5% 22.7%;           /* #314143 */
  --primary-hover: 187.1 16.2% 18%;       /* #27363A darker */
  --primary-foreground: 0 0% 95%;         /* #F2F2F2 */

  /* Secondary */
  --secondary: 0 0% 92%;
  --secondary-foreground: 180 3% 12%;     /* #1E2020 */

  /* Accent */
  --accent: 186.7 20% 86%;
  --accent-foreground: 180 3% 12%;        /* #1E2020 */

  /* Destructive = Burgundy */
  --destructive: 350.2 60.5% 29.8%;       /* burgundy #7A1E2D */
  --destructive-hover: 349.7 60.3% 24.7%; /* darker burgundy #651926 */
  --destructive-foreground: 0 0% 95%;     /* #F2F2F2 */

  /* App-specific aliases */
  --app-surface: 186.7 15.5% 22.7%;       /* #314143 navbar/footer */
  --app-surface-2: 187.1 16.2% 18%;       /* #27363A hover */
  --app-panel: 40 37.5% 96.9%;            /* #FAF8F4 solid cream dropdown bg */
  --app-panel-border: 180 3% 12%;         /* #1E2020 */
  --app-tile-bg: 186 20% 80%;             /* #C3D5D7 for module tiles */

  /* Module & interaction tokens */
  --module-tile: 186 20% 80%;             /* #C3D5D7 module card surface */
  --module-tile-border: 187 17% 37%;      /* #4F6A6E darker for distinction */
  --module-tile-hover: 186 20% 76%;       /* slightly darker hover tint */
  --module-tile-icon: 187 17% 37%;        /* matches border */
  --module: 186 20% 80%;                  /* #C3D5D7 module surface */
  --module-border: 189 20% 46%;           /* #628286 legacy */
  --ink: 180 3% 12%;                      /* #1E2020 */

  /* Interaction tokens */
  --highlight: 187.5 20.8% 69.8%;         /* #A2BEC2 selected/active bg */
  --hover: 187.5 20.8% 69.8% / 0.22;      /* rgba(162,190,194,0.22) subtle hover */
  --ring: 189 20% 46%;                    /* #628286 focus ring */
  --active-border: 186.7 15.5% 22.7%;     /* #314143 active border/text */

  /* Calendar tokens */
  --calendar-frame: 186.7 15.5% 22.7%;    /* #314143 outer border */
  --calendar-grid: 189 20% 46%;           /* #628286 internal dividers */
  --calendar-hover: 187.5 20.8% 69.8%;    /* #A2BEC2 hover wash */
  --calendar-selected: 187.5 20.8% 69.8%; /* #A2BEC2 selected */
  --calendar-surface: 0 0% 100%;          /* white surface */
}

/* APP DARK MODE */
.app-shell.dark {
  --background: 200 12% 10%;              /* deep blue-gray */
  --foreground: 40 25% 94%;

  --card: 200 10% 14%;
  --card-foreground: 40 25% 94%;

  --popover: 200 10% 14%;
  --popover-foreground: 40 25% 94%;

  --muted: 200 10% 16%;
  --muted-foreground: 200 8% 60%;

  --border: 200 10% 22%;
  --input: 200 10% 18%;
  --ring: 186 22% 60%;

  --primary: 186 22% 60%;                 /* lighter slate-blue accent */
  --primary-hover: 186 22% 55%;
  --primary-foreground: 200 12% 10%;

  --secondary: 200 10% 18%;
  --secondary-foreground: 40 25% 94%;

  --accent: 200 10% 20%;
  --accent-foreground: 40 25% 94%;

  --destructive: 350 55% 45%;
  --destructive-hover: 350 55% 38%;
  --destructive-foreground: 40 25% 94%;

  --app-surface: 200 10% 14%;
  --app-surface-2: 200 10% 18%;
  --app-panel: 200 10% 14%;               /* dark mode solid dropdown bg */
  --app-panel-border: 200 10% 28%;

  /* Dark mode interaction tokens */
  --module-tile: 195 17% 15%;             /* #1F2A2C dark tile bg */
  --module-tile-border: 188 14% 50%;      /* #6F8C90 visible border */
  --module-tile-hover: 193 18% 17%;       /* #243235 subtle hover */
  --module-tile-icon: 188 15% 73%;        /* #AFC3C6 light icon */
  --module: 200 10% 16%;
  --module-border: 186 22% 50%;
  --ink: 40 25% 94%;
  --highlight: 186 22% 45%;
  --hover: 186 22% 45% / 0.22;
  --ring: 186 22% 50%;
  --active-border: 186 22% 60%;

  /* Dark mode calendar tokens */
  --calendar-frame: 186 22% 50%;
  --calendar-grid: 186 22% 40%;
  --calendar-hover: 186 22% 45%;
  --calendar-selected: 186 22% 45%;
  --calendar-surface: 200 10% 14%;
}

/* Autofill background fix - prevent browser yellow on autofilled inputs */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active,
textarea:-webkit-autofill,
textarea:-webkit-autofill:hover,
textarea:-webkit-autofill:focus,
textarea:-webkit-autofill:active,
select:-webkit-autofill,
select:-webkit-autofill:hover,
select:-webkit-autofill:focus,
select:-webkit-autofill:active {
  -webkit-box-shadow: 0 0 0px 1000px #D6E4E6 inset !important;
  box-shadow: 0 0 0px 1000px #D6E4E6 inset !important;
  -webkit-text-fill-color: inherit !important;
  caret-color: inherit !important;
  transition: background-color 9999s ease-in-out 0s;
}

/* Only add top padding when JS sets the attribute */
body[data-civilla-fixed-nav="true"] {
  padding-top: var(--civilla-nav-h);
}

/* Fixed shell that sits above content */
.civilla-nav-shell {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  /* Keep whatever the navbar already looks like (no frosty blur) */
  backdrop-filter: none !important;
  /* Ensure dropdowns can overflow */
  overflow: visible !important;
}

/* Ensure nav inner elements don't clip dropdowns */
.civilla-nav-shell *,
.civilla-nav-shell nav {
  overflow: visible;
}

/* =========================================
   GLOBAL TEXT CONTAINMENT & RESPONSIVE RULES
   Prevents text from escaping containers on ALL pages
   ========================================= */

/* Ensure all elements calculate width correctly */
*,
*::before,
*::after {
  box-sizing: border-box;
}

/* Prevent horizontal overflow at the page level */
html,
body {
  max-width: 100%;
  overflow-x: hidden;
}

/* Theme containers apply their own backgrounds */
.theme-marketing,
.app-shell {
  background: hsl(var(--background));
  color: hsl(var(--foreground));
}

/* Ensure root and body inherit properly */
#root {
  min-height: 100%;
}

/* Core text wrapping rules - allow wrapping but not mid-word */
p,
h1,
h2,
h3,
h4,
h5,
h6,
span,
li,
a,
div {
  word-wrap: normal;
  overflow-wrap: normal;
  white-space: normal;
  hyphens: none;
}

/* Ensure containers never allow overflow */
section,
article,
main,
aside,
header,
footer,
div {
  max-width: 100%;
}

/* Card / box safety (applies to all content boxes) */
/* NOTE: Removed [class*="container"] from overflow:hidden - it clips navbar dropdowns */
.cv-card,
.card,
[class*="card"],
[class*="box"] {
  max-width: 100%;
  overflow: hidden;
}

/* Containers get max-width but NOT overflow:hidden (would clip dropdowns/modals) */
[class*="container"]:not(.civilla-nav-shell):not(.civilla-nav-shell *) {
  max-width: 100%;
}

/* Text inside cards must wrap - but no mid-word splits */
.cv-card *,
.card *,
[class*="card"] *,
[class*="box"] * {
  min-width: 0;
  word-break: normal;
  hyphens: none;
}

/* Flex & grid children must allow shrinking */
.flex > *,
.grid > * {
  min-width: 0;
}

/* =========================================
   CIVILLA BRAND STYLING
   Applies to all "civilla", "civilla.ai", "www.civilla.ai" mentions
   ========================================= */
.civilla-brand {
  display: inline;
  margin: 0;
  padding: 0;
  text-transform: lowercase;
  font-weight: 500;
  font-style: italic;
  letter-spacing: inherit;
  word-spacing: inherit;
  white-space: inherit;
}

/* Brand word: always lowercase, italic, slightly bold â€” and NO weird spacing */
.cv-brand {
  font-style: italic;
  font-weight: 600;
  text-transform: lowercase;
  white-space: nowrap;
  letter-spacing: normal;
  font-kerning: normal;
  font-feature-settings: "kern" 1;
  display: inline;
  padding: 0;
  margin: 0;
}

/* Optional helper for cases like "How civilla Works" */
.cv-brand-tight {
  letter-spacing: 0;
  word-spacing: 0;
}

/* =========================================
   CV-SPLIT: Responsive text + media layouts
   ========================================= */
.cv-split {
  display: flex;
  flex-direction: column;
  gap: 1.25rem;
}
@media (min-width: 768px) {
  .cv-split {
    flex-direction: row;
    align-items: stretch;
  }
}

.cv-split > * {
  min-width: 0;
}

.cv-split-text {
  flex: 1 1 0%;
  min-width: 0;
  overflow: hidden;
}

.cv-split-media {
  flex: 1 1 0%;
  min-width: 0;
  overflow: hidden;
  border-radius: 1.25rem;
}

.cv-split-media img {
  width: 100%;
  height: 100%;
  display: block;
  object-fit: cover;
}

.cv-isolate {
  isolation: isolate;
}

/* Images and media never exceed containers */
img,
svg,
video,
canvas {
  max-width: 100%;
  height: auto;
  display: block;
}

/* =========================================
   RESPONSIVE TEXT SIZING & WRAPPING
   Prevents awkward word breaks across all pages
   ========================================= */

/* Headings: balanced text distribution for cleaner line breaks */
h1, h2, h3, h4, h5, h6,
.cv-h {
  text-wrap: balance;
  hyphens: none;
}

/* Paragraphs: prevent orphans and widows */
p,
.cv-p,
.cv-panel-body {
  text-wrap: pretty;
  hyphens: none;
}

/* Responsive font sizing using clamp() - scales between min and max based on viewport */
/* Large headings (84px designs) */
.text-\[84px\] {
  font-size: clamp(48px, 6vw, 84px) !important;
}

/* Medium-large headings (60px designs) */
.text-\[60px\] {
  font-size: clamp(36px, 4.5vw, 60px) !important;
}

/* Medium headings (32px designs) */
.text-\[32px\] {
  font-size: clamp(24px, 2.5vw, 32px) !important;
}

/* Subheadings (26px designs) */
.text-\[26px\] {
  font-size: clamp(20px, 2vw, 26px) !important;
}

/* Body text (20px designs) */
.text-\[20px\] {
  font-size: clamp(16px, 1.5vw, 20px) !important;
}

/* Standard text (18px designs) */
.text-\[18px\] {
  font-size: clamp(15px, 1.4vw, 18px) !important;
}

/* Prevent single letters from wrapping to new line */
.no-orphan {
  text-wrap: balance;
}

/* Pricing display - keep price and period together */
.pricing-display {
  white-space: nowrap;
  display: inline-flex;
  align-items: baseline;
  flex-wrap: nowrap;
}

/* Responsive pricing text that scales with container - sized for 4-column card layout */
.price-value {
  font-size: clamp(28px, 3vw, 48px);
  white-space: nowrap;
  line-height: 1.1;
}

.price-period {
  font-size: clamp(14px, 1.5vw, 24px);
  white-space: nowrap;
}

/* Pricing card layout - ensure buttons align */
.pricing-card {
  display: flex;
  flex-direction: column;
}

.pricing-card-header {
  flex: 0 0 auto;
}

.pricing-card-price {
  flex: 0 0 auto;
}

.pricing-card-features {
  flex: 1 1 auto;
}

:root {
  --button-outline: rgba(0,0,0, .10);
  --badge-outline: rgba(0,0,0, .05);
  --opaque-button-border-intensity: -8;
  --elevate-1: rgba(0,0,0, .03);
  --elevate-2: rgba(0,0,0, .08);
  --background: 40 28% 98%;
  --foreground: 20 17% 3%;
  --border: 20 17% 88%;
  --card: 40 28% 98%;
  --card-foreground: 20 17% 3%;
  --card-border: 20 17% 88%;
  --sidebar: 40 28% 94%;
  --sidebar-foreground: 158 78% 8%;
  --sidebar-border: 40 28% 90%;
  --sidebar-primary: 158 52% 15%;
  --sidebar-primary-foreground: 40 28% 98%;
  --sidebar-accent: 40 28% 90%;
  --sidebar-accent-foreground: 158 78% 12%;
  --sidebar-ring: 158 52% 15%;
  --popover: 40 28% 92%;
  --popover-foreground: 20 17% 3%;
  --popover-border: 40 28% 88%;
  --primary: 158 52% 15%;
  --primary-foreground: 40 28% 98%;
  --secondary: 0 0% 95%;
  --secondary-foreground: 20 17% 3%;
  --muted: 158 10% 83%;
  --muted-foreground: 20 10% 35%;
  --accent: 158 10% 83%;
  --accent-foreground: 20 17% 3%;
  --destructive: 0 72% 28%;
  --destructive-foreground: 0 72% 98%;
  --input: 20 17% 3%;
  --ring: 158 52% 15%;
  --chart-1: 158 78% 20%;
  --chart-2: 40 65% 30%;
  --chart-3: 158 50% 25%;
  --chart-4: 40 45% 35%;
  --chart-5: 158 40% 30%;
  --font-sans: Arimo, sans-serif;
  --font-heading: Figtree, sans-serif;
  --radius: .75rem;
  --shadow-2xs: 0px 2px 0px 0px hsl(158 78% 15% / 0.00);
  --shadow-xs: 0px 2px 0px 0px hsl(158 78% 15% / 0.00);
  --shadow-sm: 0px 1px 2px 0px rgba(7, 5, 3, 0.05);
  --shadow: 0px 2px 0px 0px hsl(158 78% 15% / 0.00), 0px 1px 2px -1px hsl(158 78% 15% / 0.00);
  --shadow-md: 0px 2px 0px 0px hsl(158 78% 15% / 0.00), 0px 2px 4px -1px hsl(158 78% 15% / 0.00);
  --shadow-lg: 0px 2px 0px 0px hsl(158 78% 15% / 0.00), 0px 4px 6px -1px hsl(158 78% 15% / 0.00);
  --shadow-xl: 0px 2px 0px 0px hsl(158 78% 15% / 0.00), 0px 8px 10px -1px hsl(158 78% 15% / 0.00);
  --shadow-2xl: 0px 2px 0px 0px hsl(158 78% 15% / 0.00);
  --tracking-normal: 0em;
  --spacing: 0.25rem;

  --sidebar-primary-border: hsl(var(--sidebar-primary));
  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
  --sidebar-accent-border: hsl(var(--sidebar-accent));
  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
  --primary-border: hsl(var(--primary));
  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
  --secondary-border: hsl(var(--secondary));
  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
  --muted-border: hsl(var(--muted));
  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
  --accent-border: hsl(var(--accent));
  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
  --destructive-border: hsl(var(--destructive));
  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
  }
}

@layer components {
  .cv-card {
    @apply rounded-2xl border-2 border-white/70 bg-[#0f3b2e];
  }

  .cv-grid-2 {
    @apply grid grid-cols-1 md:grid-cols-[320px_1fr] gap-6 items-stretch;
  }

  .cv-panel {
    @apply rounded-xl border-2 border-white/70 p-6 md:p-8 flex flex-col min-h-0;
  }

  .cv-panel-body {
    @apply min-h-0 leading-relaxed overflow-auto;
  }

  .cv-h {
    @apply font-bold leading-tight;
  }

  .cv-p {
    @apply leading-relaxed;
  }
}

@layer utilities {
  input[type="search"]::-webkit-search-cancel-button {
    @apply hidden;
  }

  [contenteditable][data-placeholder]:empty::before {
    content: attr(data-placeholder);
    color: hsl(var(--muted-foreground));
    pointer-events: none;
  }

  .no-default-hover-elevate {}
  .no-default-active-elevate {}

  .toggle-elevate::before,
  .toggle-elevate-2::before {
    content: "";
    pointer-events: none;
    position: absolute;
    inset: 0px;
    border-radius: inherit;
    z-index: -1;
  }

  .toggle-elevate.toggle-elevated::before {
    background-color: var(--elevate-2);
  }

  .border.toggle-elevate::before {
    inset: -1px;
  }

  .hover-elevate:not(.no-default-hover-elevate),
  .active-elevate:not(.no-default-active-elevate),
  .hover-elevate-2:not(.no-default-hover-elevate),
  .active-elevate-2:not(.no-default-active-elevate) {
    position: relative;
    z-index: 0;
  }

  .hover-elevate:not(.no-default-hover-elevate)::after,
  .active-elevate:not(.no-default-active-elevate)::after,
  .hover-elevate-2:not(.no-default-hover-elevate)::after,
  .active-elevate-2:not(.no-default-active-elevate)::after {
    content: "";
    pointer-events: none;
    position: absolute;
    inset: 0px;
    border-radius: inherit;
    z-index: 999;
  }

  .hover-elevate:hover:not(.no-default-hover-elevate)::after,
  .active-elevate:active:not(.no-default-active-elevate)::after {
    background-color: var(--elevate-1);
  }

  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,
  .active-elevate-2:active:not(.no-default-active-elevate)::after {
    background-color: var(--elevate-2);
  }

  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,
  .border.active-elevate:not(.no-active-interaction-elevate)::after,
  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,
  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,
  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {
    inset: -1px;
  }

  .button-inset-shadow {
    box-shadow: inset 0px 32px 24px 0px rgba(255,255,255,0.05),
                inset 0px 2px 1px 0px rgba(255,255,255,0.25),
                inset 0px 0px 0px 1px rgba(7,5,3,0.15),
                inset 0px -2px 1px 0px rgba(0,0,0,0.2);
  }
}

/* =========================================
   GLOBAL NO-HYPHEN RULES (MUST BE AT BOTTOM TO WIN)
   Prevents mid-word splits like "orga-nized"
   ========================================= */

html, body {
  -webkit-hyphens: none;
  hyphens: none;
  word-break: normal;
  overflow-wrap: normal;
}

/* Safety net for common text elements */
h1, h2, h3, h4, h5, h6,
p, li, span, a, button, label, small, strong, em,
blockquote, dd, dt, figcaption {
  -webkit-hyphens: none;
  hyphens: none;
  word-break: normal;
  overflow-wrap: normal;
}

/* If Tailwind Typography (.prose) is used anywhere */
.prose, .prose * {
  -webkit-hyphens: none;
  hyphens: none;
  word-break: normal;
  overflow-wrap: normal;
}

/* Safe text container utility for flex/grid children */
.safe-text-container {
  min-width: 0;
  overflow: hidden;
}

/* Calendar utility classes (app scope only) */
.app-shell .calendar-frame {
  border-color: hsl(var(--calendar-frame)) !important;
}
.app-shell .calendar-grid {
  border-color: hsl(var(--calendar-grid)) !important;
}
.app-shell .calendar-surface {
  background: hsl(var(--calendar-surface)) !important;
}
