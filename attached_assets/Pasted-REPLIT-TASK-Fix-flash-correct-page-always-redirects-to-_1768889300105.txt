REPLIT TASK: Fix “flash correct page → always redirects to Your Case” bug (route guard redirect loop)

Problem
Inside /app, clicking most module links briefly shows the correct page, then automatically redirects back to “Your Case” (case dashboard redirect). That means we have a global navigate() firing after render (usually in AppLayout/AppRouter) that forces /app → /app/dashboard/:caseId even when the user is already on a valid route.

Goal
Only redirect to “Your Case” when the user is actually on:
- /app  (root)
- /app/dashboard (no caseId)
- OR on a case-required route that is missing the :caseId param
Never redirect when the user is already on a valid route like /app/evidence/:caseId, /app/documents/:caseId, /app/account, /app/start-here, etc.

Do this:

A) Find the redirect code
Search the client for any forced navigation to dashboard:
- navigate("/app/dashboard")
- navigate(`/app/dashboard/${`)
- "Your Case"
- "case redirect"
- "CaseRedirect"
- "activeCaseId"
- "selectedCaseId"
- "defaultCase"
- "lastCaseId"

Likely files:
- client/src/App.tsx
- client/src/components/layout/AppLayout.tsx
- client/src/routes/*.tsx
- client/src/lib/caseFlow.ts or similar
- any “CaseRedirect” component

B) Fix the redirect logic (this is the key)
Wherever the redirect useEffect is, change it to:

1) Read current pathname via useLocation()
2) Redirect ONLY if:
   - pathname === "/app"
   - OR pathname === "/app/dashboard"
   - OR (route requires a caseId and we don’t have one)

3) DO NOT redirect when pathname already matches a valid target route.

Implementation pattern (React Router):

- In the redirect useEffect:
  - const { pathname } = useLocation()
  - const caseId = selectedCaseId || lastCaseId
  - const isCaseRequiredRoute =
      pathname.startsWith("/app/dashboard") ||
      pathname.startsWith("/app/evidence") ||
      pathname.startsWith("/app/timeline") ||
      pathname.startsWith("/app/documents") ||
      pathname.startsWith("/app/patterns") ||
      pathname.startsWith("/app/exhibits") ||
      pathname.startsWith("/app/trial-prep") ||
      ... (all modules that use :caseId)
  - const routeHasCaseIdParam = pathname.split("/").length >= 4  (or use matchPath)

Redirect rules:
- If pathname === "/app" AND caseId exists => navigate(`/app/dashboard/${caseId}`, { replace: true })
- If pathname === "/app/dashboard" AND caseId exists => navigate(`/app/dashboard/${caseId}`, { replace: true })
- If isCaseRequiredRoute is true AND routeHasCaseIdParam is false AND caseId exists => navigate(`${pathname}/${caseId}`, { replace: true })  (or navigate to dashboard)
- Otherwise: do nothing.

IMPORTANT:
- Remove any logic like “if (caseId) navigate(/app/dashboard/${caseId})” without checking pathname.
That exact pattern is what causes the “flash then snap back” behavior.

C) Prevent double-runs
If React StrictMode is causing the effect to run twice in dev, guard with a ref:
- const didRedirect = useRef(false)
- if (didRedirect.current) return
- set didRedirect.current = true only when you actually navigate()

D) Verify with a simple manual test matrix
After fix:
1) Login, select a case.
2) Click each nav item:
- Evidence, Timeline, Documents, Exhibits, Pattern Analysis, Trial Prep, etc.
Expected: stays on that page; does NOT bounce back to Your Case.
3) Go to /app directly:
Expected: redirects to /app/dashboard/:caseId (this is correct).
4) Go to /app/evidence (missing caseId):
Expected: redirects to /app/evidence/:caseId OR to dashboard (either is acceptable, but must be consistent).

E) Report back
In your response, include:
- File(s) changed
- The exact redirect useEffect you modified
- Confirmation the redirect now triggers ONLY on /app and /app/dashboard (or missing caseId routes)

Do NOT change backend routes for this. This is a frontend navigation/guard bug.